<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ä½¿ç”¨ Rust å’Œ WebAssembly æ„å»ºçš„é—²ç½®æ¸¸æˆ">
    <title>Rust WASM é—²ç½®æ¸¸æˆ</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/ascii-style.css">
</head>
<body>
    <div id="game-container">
        <header>
            <div id="coin-button" class="clickable">
                <span id="coin-count">0</span>
            </div>
            <h1 id="game-title">Rust WASM é—²ç½®æ¸¸æˆ</h1>
            <p id="click-to-earn">ç‚¹å‡»èµšå–é‡‘å¸å¹¶è´­ä¹°å‡çº§ï¼</p>
        </header>
        
        <!-- Banner Area - Resource Display -->
        <div id="banner">
            <div id="resources">
                <div class="resource-item">
                    <span class="resource-icon">ğŸª™</span>
                    <span id="coins">é‡‘å¸ï¼š0</span>
                </div>
                <div class="resource-item">
                    <span class="resource-icon">ğŸªµ</span>
                    <span id="wood">æœ¨å¤´ï¼š0</span>
                </div>
                <div class="resource-item">
                    <span class="resource-icon">ğŸª¨</span>
                    <span id="stone">çŸ³å¤´ï¼š0</span>
                </div>
                <div class="resource-item resource-rate">
                    <span class="resource-icon">â±ï¸</span>
                    <span id="cps">é‡‘å¸/ç§’ï¼š0</span>
                </div>
                <div class="resource-item resource-rate">
                    <span class="resource-icon">ğŸŒ²</span>
                    <span id="wps">æœ¨å¤´/ç§’ï¼š0</span>
                </div>
                <div class="resource-item resource-rate">
                    <span class="resource-icon">â›ï¸</span>
                    <span id="sps">çŸ³å¤´/ç§’ï¼š0</span>
                </div>
                <div class="resource-item resource-rate">
                    <span class="resource-icon">âš¡</span>
                    <span id="cpc">é‡‘å¸/ç‚¹å‡»ï¼š1</span>
                </div>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div id="tab-navigation">
            <button class="tab-button active" data-tab="upgrades">å‡çº§</button>
            <button class="tab-button" data-tab="buildings">å»ºç­‘</button>
            <button class="tab-button" data-tab="workers">å·¥äºº</button>
            <button class="tab-button" data-tab="statistics">ç»Ÿè®¡</button>
            <button class="tab-button" data-tab="achievements">æˆå°±</button>
            <button class="tab-button" data-tab="crafting">åˆæˆ</button>
            <button class="tab-button" data-tab="unlocks">è§£é”</button>
            <button class="tab-button" data-tab="settings">è®¾ç½®</button>
        </div>
        
        <!-- Main Content Area with Tabs -->
        <main id="main-content">
            <!-- Upgrades Tab -->
            <div id="tab-upgrades" class="tab-content active">
                <div id="upgrades">
                    <h3 id="upgrades-header">å‡çº§</h3>
                    <div id="upgrade-list"></div>
                </div>
            </div>
            
            <!-- Buildings Tab -->
            <div id="tab-buildings" class="tab-content">
                <div id="buildings">
                    <h3 id="buildings-header">å»ºç­‘</h3>
                    <div id="building-list"></div>
                </div>
            </div>
            
            <!-- Workers Tab -->
            <div id="tab-workers" class="tab-content">
                <div id="workers">
                    <h3 id="workers-header">å·¥äºº</h3>
                    <div id="workers-list">
                        <p id="workers-placeholder">å·¥äººç³»ç»Ÿå°†åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å®ç°</p>
                    </div>
                </div>
            </div>
            
            <!-- Statistics Tab -->
            <div id="tab-statistics" class="tab-content">
                <div id="statistics">
                    <h3 id="statistics-header">ç»Ÿè®¡</h3>
                    <div id="statistics-list"></div>
                </div>
            </div>
            
            <!-- Achievements Tab -->
            <div id="tab-achievements" class="tab-content">
                <div id="achievements">
                    <h3 id="achievements-header">æˆå°±</h3>
                    <div id="achievements-list">
                        <p id="achievements-placeholder">æˆå°±ç³»ç»Ÿå°†åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å®ç°</p>
                    </div>
                </div>
            </div>
            
            <!-- Crafting Tab -->
            <div id="tab-crafting" class="tab-content">
                <div id="crafting">
                    <h3 id="crafting-header">åˆæˆ</h3>
                    <div id="crafting-list">
                        <p id="crafting-placeholder">åˆæˆç³»ç»Ÿå°†åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å®ç°</p>
                    </div>
                </div>
            </div>
            
            <!-- Unlocks Tab -->
            <div id="tab-unlocks" class="tab-content">
                <div id="unlocks">
                    <h3 id="unlocks-header">è§£é”</h3>
                    <div id="unlock-list">
                        <p id="unlocks-placeholder">è§£é”ç³»ç»Ÿå°†åœ¨æœªæ¥ç‰ˆæœ¬ä¸­å®ç°</p>
                    </div>
                </div>
            </div>
            
            <!-- Settings Tab -->
            <div id="tab-settings" class="tab-content">
                <div id="settings">
                    <h3 id="settings-header">è®¾ç½®</h3>
                    <div id="settings-content">
                        <div class="setting-item">
                            <label for="theme-select-setting">ä¸»é¢˜ / Theme:</label>
                            <select id="theme-select-setting">
                                <option value="light">ç¥ç€ç»ˆç«¯ (Amber)</option>
                                <option value="dark">ç»¿è‰²ç»ˆç«¯ (Green)</option>
                                <option value="cyan">é’è‰²ç»ˆç«¯ (Cyan)</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="language-select-setting">è¯­è¨€ / Language:</label>
                            <select id="language-select-setting">
                                <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>æ¸¸æˆç‰ˆæœ¬ï¼šv0.2.3</label>
                        </div>
                        <div class="setting-item">
                            <button id="reset-game">é‡ç½®æ¸¸æˆ</button>
                        </div>
                        <hr style="margin: 20px 0; border: 1px solid #ccc;">
                        <div class="setting-item">
                            <h4 style="margin: 10px 0;">ä¿å­˜/åŠ è½½ Save</h4>
                        </div>
                        <div class="setting-item">
                            <button id="manual-save">æ‰‹åŠ¨ä¿å­˜</button>
                            <span id="save-status" style="margin-left: 10px; font-size: 12px;"></span>
                        </div>
                        <div class="setting-item">
                            <button id="export-base64">å¯¼å‡ºä¸º BASE64</button>
                        </div>
                        <div class="setting-item">
                            <textarea id="import-export-text" placeholder="åœ¨æ­¤ç²˜è´´ BASE64 å­—ç¬¦ä¸²..." rows="4" style="width: 100%; font-family: monospace; font-size: 12px;"></textarea>
                        </div>
                        <div class="setting-item">
                            <button id="import-base64">ä» BASE64 å¯¼å…¥</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <footer>
            <span id="footer-text">ä½¿ç”¨ Rust å’Œ WebAssembly æ„å»ºçš„é—²ç½®æ¸¸æˆæ¡†æ¶</span>
            <span id="version-info">Version: <span id="version-number">v0.2.3</span></span>
        </footer>
    </div>
    
    <!-- æ³¨æ„ï¼šåœ¨æ„å»ºåæ­¤è„šæœ¬å°†è¢«æ›¿æ¢ä¸ºå®é™…çš„ WASM ç»‘å®š -->
    <script src="js/i18n.js"></script>
    <script src="js/game.js"></script>
    <script src="js/statistics.js"></script>
    <script src="js/crafting.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/unlocks.js"></script>
    <script src="js/workers.js"></script>
    <script src="js/bootstrap.js"></script>
    
    <!-- Tab navigation and settings script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab navigation
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Remove active class from all buttons and contents
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked button and corresponding content
                    this.classList.add('active');
                    document.getElementById(`tab-${tabName}`).classList.add('active');
                    
                    // Call render function for specific tabs when activated
                    if (tabName === 'achievements' && window.achievementsManager) {
                        window.achievementsManager.renderAchievements();
                    } else if (tabName === 'statistics' && window.statisticsManager) {
                        window.statisticsManager.renderToPanel('tab-statistics');
                    } else if (tabName === 'crafting' && window.craftingManager) {
                        window.craftingManager.renderRecipes();
                    } else if (tabName === 'unlocks' && window.unlockManager) {
                        window.unlockManager.renderUnlocks();
                    } else if (tabName === 'workers' && window.workerManager) {
                        window.workerManager.renderWorkers();
                    }
                });
            });
            
            // Theme management
            function loadTheme() {
                const savedTheme = localStorage.getItem('gameTheme') || 'light';
                return savedTheme;
            }
            
            function applyTheme(theme) {
                // Remove all theme classes first
                document.body.classList.remove('dark-theme', 'cyan-theme');
                
                // Apply selected theme
                if (theme === 'dark') {
                    document.body.classList.add('dark-theme');
                } else if (theme === 'cyan') {
                    document.body.classList.add('cyan-theme');
                }
                // light theme is default (no class needed)
                
                // Update both theme selectors
                const themeSelect = document.getElementById('theme-select');
                const themeSelectSetting = document.getElementById('theme-select-setting');
                if (themeSelect) themeSelect.value = theme;
                if (themeSelectSetting) themeSelectSetting.value = theme;
            }
            
            function saveTheme(theme) {
                localStorage.setItem('gameTheme', theme);
            }
            
            // Initialize theme on page load
            const currentTheme = loadTheme();
            applyTheme(currentTheme);
            
            // Theme selector in header
            const themeSelect = document.getElementById('theme-select');
            if (themeSelect) {
                themeSelect.addEventListener('change', function() {
                    const selectedTheme = this.value;
                    applyTheme(selectedTheme);
                    saveTheme(selectedTheme);
                });
            }
            
            // Theme selector in settings
            const themeSelectSetting = document.getElementById('theme-select-setting');
            if (themeSelectSetting) {
                themeSelectSetting.addEventListener('change', function() {
                    const selectedTheme = this.value;
                    applyTheme(selectedTheme);
                    saveTheme(selectedTheme);
                });
            }
            
            // Language selector in header
            const languageSelect = document.getElementById('language-select');
            if (languageSelect) {
                languageSelect.addEventListener('change', function() {
                    const selectedLanguage = this.value;
                    if (window.i18n) {
                        window.i18n.setLanguage(selectedLanguage);
                        window.i18n.updateAllTranslations();
                        // Update HTML lang attribute
                        document.documentElement.lang = selectedLanguage;
                    }
                });
            }
            
            // Language selector in settings
            const languageSelectSetting = document.getElementById('language-select-setting');
            if (languageSelectSetting) {
                languageSelectSetting.addEventListener('change', function() {
                    const selectedLanguage = this.value;
                    if (window.i18n) {
                        window.i18n.setLanguage(selectedLanguage);
                        window.i18n.updateAllTranslations();
                        // Update both language selectors
                        document.getElementById('language-select').value = selectedLanguage;
                        document.documentElement.lang = selectedLanguage;
                    }
                });
            }
            
            // Reset game button
            const resetButton = document.getElementById('reset-game');
            if (resetButton) {
                resetButton.addEventListener('click', function() {
                    if (confirm('ç¡®å®šè¦é‡ç½®æ¸¸æˆå—ï¼Ÿæ‰€æœ‰è¿›åº¦å°†ä¸¢å¤±ï¼')) {
                        // Reload the page to reset the game
                        location.reload();
                    }
                });
            }
        });
    </script>
</body>
</html>
