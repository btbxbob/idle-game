<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="使用 Rust 和 WebAssembly 构建的闲置游戏">
    <title>Rust WASM 闲置游戏</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/ascii-style.css">
</head>
<body>
    <div id="game-container">
        <header>
            <h1 id="game-title">Rust WASM 闲置游戏</h1>
            <p id="click-to-earn">点击赚取金币并购买升级！</p>
            <!-- Theme selector -->
            <div id="theme-selector">
                <select id="theme-select">
                    <option value="light">亮色主题</option>
                    <option value="dark">暗色主题</option>
                </select>
            </div>
            <!-- Language selector -->
            <div id="language-selector">
                <select id="language-select">
                    <option value="zh-CN">简体中文</option>
                    <option value="en">English</option>
                </select>
            </div>
        </header>
        
        <!-- Banner Area - Resource Display -->
        <div id="banner">
            <div id="resources">
                <div class="resource-item">
                    <span id="coins">金币：0</span>
                </div>
                <div class="resource-item">
                    <span id="wood">木头：0</span>
                </div>
                <div class="resource-item">
                    <span id="stone">石头：0</span>
                </div>
                <div class="resource-item">
                    <span id="cps">金币/秒：0</span>
                </div>
                <div class="resource-item">
                    <span id="wps">木头/秒：0</span>
                </div>
                <div class="resource-item">
                    <span id="sps">石头/秒：0</span>
                </div>
                <div class="resource-item">
                    <span id="cpc">金币/点击：1</span>
                </div>
            </div>
        </div>
        
        <!-- Tab Navigation -->
        <div id="tab-navigation">
            <button class="tab-button active" data-tab="resources">资源</button>
            <button class="tab-button" data-tab="upgrades">升级</button>
            <button class="tab-button" data-tab="buildings">建筑</button>
            <button class="tab-button" data-tab="workers">工人</button>
            <button class="tab-button" data-tab="statistics">统计</button>
            <button class="tab-button" data-tab="achievements">成就</button>
            <button class="tab-button" data-tab="crafting">合成</button>
            <button class="tab-button" data-tab="unlocks">解锁</button>
            <button class="tab-button" data-tab="settings">设置</button>
        </div>
        
        <!-- Main Content Area with Tabs -->
        <main id="main-content">
            <!-- Resources Tab -->
            <div id="tab-resources" class="tab-content active">
                <div id="main-area">
                    <div id="click-area" class="clickable">
                        <div id="coin-display">0</div>
                        <p id="click-to-earn-coins">点击赚取金币</p>
                    </div>
                </div>
            </div>
            
            <!-- Upgrades Tab -->
            <div id="tab-upgrades" class="tab-content">
                <div id="upgrades">
                    <h3 id="upgrades-header">升级</h3>
                    <div id="upgrade-list"></div>
                </div>
            </div>
            
            <!-- Buildings Tab -->
            <div id="tab-buildings" class="tab-content">
                <div id="buildings">
                    <h3 id="buildings-header">建筑</h3>
                    <div id="building-list"></div>
                </div>
            </div>
            
            <!-- Workers Tab -->
            <div id="tab-workers" class="tab-content">
                <div id="workers">
                    <h3 id="workers-header">工人</h3>
                    <div id="workers-list">
                        <p id="workers-placeholder">工人系统将在未来版本中实现</p>
                    </div>
                </div>
            </div>
            
            <!-- Statistics Tab -->
            <div id="tab-statistics" class="tab-content">
                <div id="statistics">
                    <h3 id="statistics-header">统计</h3>
                    <div id="statistics-list"></div>
                </div>
            </div>
            
            <!-- Achievements Tab -->
            <div id="tab-achievements" class="tab-content">
                <div id="achievements">
                    <h3 id="achievements-header">成就</h3>
                    <div id="achievements-list">
                        <p id="achievements-placeholder">成就系统将在未来版本中实现</p>
                    </div>
                </div>
            </div>
            
            <!-- Crafting Tab -->
            <div id="tab-crafting" class="tab-content">
                <div id="crafting">
                    <h3 id="crafting-header">合成</h3>
                    <div id="crafting-list">
                        <p id="crafting-placeholder">合成系统将在未来版本中实现</p>
                    </div>
                </div>
            </div>
            
            <!-- Unlocks Tab -->
            <div id="tab-unlocks" class="tab-content">
                <div id="unlocks">
                    <h3 id="unlocks-header">解锁</h3>
                    <div id="unlock-list">
                        <p id="unlocks-placeholder">解锁系统将在未来版本中实现</p>
                    </div>
                </div>
            </div>
            
            <!-- Settings Tab -->
            <div id="tab-settings" class="tab-content">
                <div id="settings">
                    <h3 id="settings-header">设置</h3>
                    <div id="settings-content">
                        <div class="setting-item">
                            <label for="theme-select-setting">主题 / Theme:</label>
                            <select id="theme-select-setting">
                                <option value="light">亮色主题</option>
                                <option value="dark">暗色主题</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="language-select-setting">语言 / Language:</label>
                            <select id="language-select-setting">
                                <option value="zh-CN">简体中文</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>游戏版本：v0.2.3</label>
                        </div>
                        <div class="setting-item">
                            <button id="reset-game">重置游戏</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <footer>
            <span id="footer-text">使用 Rust 和 WebAssembly 构建的闲置游戏框架</span>
            <span id="version-info">Version: <span id="version-number">v0.2.3</span></span>
        </footer>
    </div>
    
    <!-- 注意：在构建后此脚本将被替换为实际的 WASM 绑定 -->
    <script src="js/i18n.js"></script>
    <script src="js/game.js"></script>
    <script src="js/statistics.js"></script>
    <script src="js/crafting.js"></script>
    <script src="js/achievements.js"></script>
    <script src="js/unlocks.js"></script>
    <script src="js/workers.js"></script>
    <script src="js/bootstrap.js"></script>
    
    <!-- Tab navigation and settings script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab navigation
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Remove active class from all buttons and contents
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked button and corresponding content
                    this.classList.add('active');
                    document.getElementById(`tab-${tabName}`).classList.add('active');
                    
                    // Call render function for specific tabs when activated
                    if (tabName === 'achievements' && window.achievementsManager) {
                        window.achievementsManager.renderAchievements();
                    } else if (tabName === 'statistics' && window.statisticsManager) {
                        window.statisticsManager.renderStatistics();
                    } else if (tabName === 'crafting' && window.craftingManager) {
                        window.craftingManager.renderCrafting();
                    } else if (tabName === 'unlocks' && window.unlockManager) {
                        window.unlockManager.renderUnlocks();
                    } else if (tabName === 'workers' && window.workerManager) {
                        window.workerManager.renderWorkers();
                    }
                });
            });
            
            // Theme management
            function loadTheme() {
                const savedTheme = localStorage.getItem('gameTheme') || 'light';
                return savedTheme;
            }
            
            function applyTheme(theme) {
                if (theme === 'dark') {
                    document.body.classList.add('dark-theme');
                } else {
                    document.body.classList.remove('dark-theme');
                }
                // Update both theme selectors
                const themeSelect = document.getElementById('theme-select');
                const themeSelectSetting = document.getElementById('theme-select-setting');
                if (themeSelect) themeSelect.value = theme;
                if (themeSelectSetting) themeSelectSetting.value = theme;
            }
            
            function saveTheme(theme) {
                localStorage.setItem('gameTheme', theme);
            }
            
            // Initialize theme on page load
            const currentTheme = loadTheme();
            applyTheme(currentTheme);
            
            // Theme selector in header
            const themeSelect = document.getElementById('theme-select');
            if (themeSelect) {
                themeSelect.addEventListener('change', function() {
                    const selectedTheme = this.value;
                    applyTheme(selectedTheme);
                    saveTheme(selectedTheme);
                });
            }
            
            // Theme selector in settings
            const themeSelectSetting = document.getElementById('theme-select-setting');
            if (themeSelectSetting) {
                themeSelectSetting.addEventListener('change', function() {
                    const selectedTheme = this.value;
                    applyTheme(selectedTheme);
                    saveTheme(selectedTheme);
                });
            }
            
            // Language selector in header
            const languageSelect = document.getElementById('language-select');
            if (languageSelect) {
                languageSelect.addEventListener('change', function() {
                    const selectedLanguage = this.value;
                    if (window.i18n) {
                        window.i18n.setLanguage(selectedLanguage);
                        window.i18n.updateAllTranslations();
                        // Update HTML lang attribute
                        document.documentElement.lang = selectedLanguage;
                    }
                });
            }
            
            // Language selector in settings
            const languageSelectSetting = document.getElementById('language-select-setting');
            if (languageSelectSetting) {
                languageSelectSetting.addEventListener('change', function() {
                    const selectedLanguage = this.value;
                    if (window.i18n) {
                        window.i18n.setLanguage(selectedLanguage);
                        window.i18n.updateAllTranslations();
                        // Update both language selectors
                        document.getElementById('language-select').value = selectedLanguage;
                        document.documentElement.lang = selectedLanguage;
                    }
                });
            }
            
            // Reset game button
            const resetButton = document.getElementById('reset-game');
            if (resetButton) {
                resetButton.addEventListener('click', function() {
                    if (confirm('确定要重置游戏吗？所有进度将丢失！')) {
                        // Reload the page to reset the game
                        location.reload();
                    }
                });
            }
        });
    </script>
</body>
</html>
